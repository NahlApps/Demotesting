<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="tokyo-neon">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Tiger77 â€” Ø­Ø¬Ø² ØºØ³ÙŠÙ„ Ø³ÙŠØ§Ø±Ø§Øª (Ø£Ø³Ù„ÙˆØ¨ Ø·ÙˆÙƒÙŠÙˆ)</title>

  <!-- Arabic + JP vibe -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800;900&family=Noto+Sans+JP:wght@400;700;900&display=swap" rel="stylesheet">

  <!-- ====== TOKYO NEON THEME (RTL + Arabic) ====== -->
  <style>
  :root{
    --primary-900:#071222;
    --primary-800:#0A1F3F;
    --primary-700:#0E2A55;
    --primary-600:#0B7CFF;
    --primary-500:#36A2FF;
    --primary-300:#7CC0FF;

    --accent-600:#E60012;

    --ink-100:#F1F6FF;
    --ink-200:#D9E4FA;
    --ink-300:#B7C6E5;

    --surface-900:#0A0F1A;
    --surface-card:rgba(10,15,26,.86);
    --border-700:#1E2B40;
    --border-600:#24344F;

    --shadow-xs:0 2px 6px rgba(0,0,0,.12);
    --shadow-sm:0 8px 24px rgba(0,0,0,.18);
    --shadow-md:0 16px 36px rgba(0,0,0,.22);
    --radius-md:14px; --radius-pill:999px;
    --ease:cubic-bezier(.22,.61,.36,1);
    --dur-xs:160ms; --dur-sm:220ms; --dur-md:460ms;

    --grid: repeating-linear-gradient(0deg, rgba(255,255,255,.04) 0 1px, transparent 1px 28px);
  }

  html,body{height:100%}
  body{
    margin:0;
    font-family:"Cairo","Noto Sans JP",system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
    color:var(--ink-100);
    background:
      radial-gradient(1100px 520px at 70% -10%, rgba(11,124,255,.18), transparent 60%),
      radial-gradient(900px 500px at 10% 120%, rgba(230,0,18,.12), transparent 55%),
      var(--grid),
      var(--primary-900);
    min-height:100dvh; display:flex; flex-direction:column;
  }

  h1,h2{ font-weight:900; letter-spacing:.2px; margin:0; }
  p, label, .muted{ color:var(--ink-300) }

  /* Header */
  header{
    position:fixed; inset:0 0 auto 0; z-index:50;
    background:linear-gradient(180deg,var(--primary-700),var(--primary-800));
    backdrop-filter:blur(6px);
    border-bottom:1px solid rgba(255,255,255,.12);
  }
  .header-inner{ max-width:1120px; margin:0 auto; padding:10px 12px; display:flex; align-items:center; gap:12px; justify-content:space-between }
  .brand{ display:flex; align-items:center; gap:10px; padding:6px 10px; border-radius:12px; background:rgba(255,255,255,.06); box-shadow:inset 0 0 0 1px rgba(255,255,255,.12) }
  .brand img{ height:64px; filter:drop-shadow(0 10px 18px rgba(0,0,0,.28)) }
  .header-right{flex:1; display:flex; flex-direction:column; gap:6px}

  .mini-progress{display:flex; align-items:center; gap:10px; width:100%}
  .mini-progress .bar{flex:1; height:8px; background:rgba(255,255,255,.18); border-radius:999px; overflow:hidden}
  .mini-progress .bar>span{display:block; height:100%; width:0%; background:linear-gradient(90deg,var(--primary-600),var(--primary-500)); transition:width var(--dur-md) var(--ease)}
  .mini-progress .step{font-weight:800; font-size:1rem}

  .summary-chips{display:flex; flex-wrap:wrap; gap:6px; align-items:center}
  .chip{display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border:1px solid rgba(255,255,255,.42); border-radius:999px; color:#fff; background:rgba(255,255,255,.12); font-size:.85rem}
  .chip.current{background:rgba(255,255,255,.22); border-color:rgba(255,255,255,.82)}

  /* Layout */
  main{flex:1 0 auto; display:flex; justify-content:center; padding:calc(72px + 16px) 12px 88px}
  #app{width:100%; max-width:1120px}
  .stage{position:relative; min-height:520px; padding:8px 0 20px}
  .page{position:absolute; inset:0; display:flex; flex-direction:column; align-items:center; gap:20px; padding:24px 12px 28px; overflow:auto; opacity:0; transform:translateY(12px) scale(.992); pointer-events:none}
  .page.active{ pointer-events:auto; animation:pageIn var(--dur-md) var(--ease) both }
  .page.exit{ animation:pageOut var(--dur-sm) var(--ease) both }
  @keyframes pageIn{from{opacity:0; transform:translateY(12px) scale(.992)}to{opacity:1; transform:translateY(0) scale(1)}}
  @keyframes pageOut{from{opacity:1; transform:translateY(0) scale(1)}to{opacity:0; transform:translateY(14px) scale(.985)}}
  .page h1{font-size:1.5rem}

  .card{
    background:var(--surface-card);
    border:1px solid var(--border-700);
    color:var(--ink-100);
    border-radius:var(--radius-md);
    box-shadow:var(--shadow-md);
    padding:24px; width:100%; max-width:920px; backdrop-filter:blur(4px);
  }

  /* Form */
  .grid{display:grid; gap:14px}
  .grid.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
  @media (max-width:720px){ .grid.cols-2{grid-template-columns:1fr} }
  label{ font-weight:800; display:block; margin:2px 0 6px; color:var(--ink-200) }

  .form-control, select{
    width:100%; background:#0f1622; color:#e9f2ff;
    border:1px solid var(--border-600); border-radius:14px;
    min-height:48px; padding:12px 14px; font-size:16px; outline:none;
    transition:border-color var(--dur-xs) var(--ease), box-shadow var(--dur-xs) var(--ease), background var(--dur-xs) var(--ease);
  }
  .form-control::placeholder{ color:#7f8daa }
  .form-control:focus, select:focus{
    background:#0c1420; border-color:var(--primary-500);
    box-shadow:0 0 0 4px rgba(54,162,255,.22);
  }

  /* Service cards */
  .svc-grid{ display:grid; gap:14px; margin-top:8px; grid-template-columns:repeat(3,minmax(0,1fr)); }
  @media (max-width:980px){ .svc-grid{ grid-template-columns:repeat(2,minmax(0,1fr)); } }
  @media (max-width:560px){ .svc-grid{ grid-template-columns:1fr; } }

  .svc-card{
    background:#0f1622; border:1px solid var(--border-600);
    border-radius:14px; padding:12px; display:flex; gap:12px; align-items:center;
    cursor:pointer; outline:none; box-shadow:var(--shadow-xs);
    transition:transform var(--dur-xs), box-shadow var(--dur-xs), background var(--dur-xs), border-color var(--dur-xs);
    min-height:108px; position:relative;
  }
  .svc-card:hover{ transform:translateY(-2px); background:#0c1420; box-shadow:var(--shadow-sm); border-color:#314665 }
  .svc-card[aria-checked="true"]{ outline:3px solid var(--primary-600); outline-offset:2px; box-shadow:0 0 0 3px rgba(11,124,255,.18) inset }
  .svc-card[aria-disabled="true"]{ opacity:.48; pointer-events:none }

  .svc-thumb{ width:84px;height:84px;border-radius:12px;overflow:hidden;background:#121a28;border:1px solid #1f2a3d; display:flex;align-items:center;justify-content:center; font-size:36px }
  .svc-title{ font-weight:900; margin:0 0 4px }
  .svc-desc{ color:#a6b5d4; margin:0 0 8px; font-size:.94rem }
  .svc-cat{ background:var(--accent-600); color:#fff; border:0; padding:2px 8px; border-radius:999px; font-size:.75rem; margin-inline-start:auto }
  .price{ background:var(--primary-600); color:#fff; font-weight:800; font-size:.8rem; padding:4px 8px; border-radius:999px }

  /* Time options */
  .time-grid{display:grid; grid-template-columns:repeat(3,minmax(0,1fr)); gap:14px}
  @media (max-width:560px){ .time-grid{grid-template-columns:repeat(2,minmax(0,1fr))} }
  .time-option{
    background:#0f1622; color:#e9f2ff; font-weight:900;
    border:1px solid var(--border-600); border-radius:14px;
    padding:14px 10px; min-height:56px; box-shadow:var(--shadow-xs);
    transition:transform var(--dur-xs) var(--ease), box-shadow var(--dur-xs) var(--ease), background var(--dur-xs) var(--ease), outline-color var(--dur-xs) var(--ease);
    display:flex; align-items:center; justify-content:center; cursor:pointer;
  }
  .time-option:hover{ transform:translateY(-2px); background:#0c1420; box-shadow:var(--shadow-sm) }
  .time-option[aria-pressed="true"]{
    outline:3px solid var(--primary-600); outline-offset:2px;
    background:linear-gradient(0deg, rgba(11,124,255,.06), #0f1622);
    box-shadow:0 0 12px rgba(11,124,255,.35), inset 0 0 0 3px rgba(11,124,255,.15);
  }

  /* Footer/CTA */
  footer.sticky-nav{
    position:fixed; left:0; right:0; bottom:0; z-index:40;
    background: linear-gradient(180deg, rgba(10,31,63,.92), rgba(7,18,34,.92));
    backdrop-filter:blur(10px); border-top:1px solid rgba(255,255,255,.10);
  }
  .footer-inner{ max-width:1120px; margin:0 auto; padding:12px; display:flex; gap:12px }
  .btn{
    border:1px solid var(--border-600); border-radius:14px; padding:14px 16px; min-height:52px;
    font-weight:900; font-size:1rem; cursor:pointer; flex:1;
    background:#0f1622; color:#e9f2ff;
    transition:transform var(--dur-xs), box-shadow var(--dur-xs), background var(--dur-xs), color var(--dur-xs), border-color var(--dur-xs);
  }
  .btn:hover{ transform:translateY(-1px); box-shadow:var(--shadow-sm); background:#0c1420; border-color:#314665 }
  .btn[disabled]{ opacity:.55; pointer-events:none }

  .btn.primary{
    background:linear-gradient(180deg, var(--primary-600), #167cf8);
    color:#fff; border-color:transparent;
    text-shadow:0 1px 0 rgba(0,0,0,.18);
    box-shadow:0 12px 30px rgba(11,124,255,.35), inset 0 -6px 10px rgba(0,0,0,.12);
  }
  .btn.primary:hover{ filter:saturate(1.08) brightness(1.02) }
  .btn.ghost{ background:transparent; color:var(--ink-200); border-color:rgba(255,255,255,.35) }

  /* Toast */
  #toast{ position:fixed;top:14px;left:50%;transform:translateX(-50%);z-index:2000;display:none;padding:10px 14px;border-radius:12px;background:var(--primary-600);color:#fff;font-weight:800;box-shadow:var(--shadow-sm) }

  @media (prefers-reduced-motion:reduce){ *{animation:none!important; transition:none!important} }
  </style>
</head>

<body>
  <div id="toast"></div>

  <header>
    <div class="header-inner">
      <div class="brand">
        <img alt="Tiger77" src="https://pdnmghkpepvsfaiqlafk.supabase.co/storage/v1/object/public/nahl%20assets/Tiger77%20-%20Logo.png"/>
      </div>
      <div class="header-right">
        <div class="mini-progress" aria-hidden="true">
          <div class="bar"><span id="miniBar" style="width:0%"></span></div>
          <div class="step" id="miniStep">Ø§Ù„ØªØ±Ø­ÙŠØ¨</div>
        </div>
        <div id="chips" class="summary-chips" aria-live="polite"></div>
      </div>
      <button id="toggleTheme" class="btn ghost" style="flex:0 0 auto;min-height:40px;padding:8px 12px">NEON / ZEN</button>
    </div>
  </header>

  <main>
    <div id="app">
      <div class="stage">
        <!-- 1) Welcome -->
        <section id="page1" class="page active" aria-label="Ø§Ù„ØªØ±Ø­ÙŠØ¨">
          <h1>ğŸš— Tiger77 â€” ØºØ³ÙŠÙ„ Ø³ÙŠØ§Ø±Ø§Øª Ù…ØªÙ†Ù‚Ù„ Ø¨Ø£Ø³Ù„ÙˆØ¨ Ø·ÙˆÙƒÙŠÙˆ</h1>
          <div class="card">
            <p class="muted">Ù†Ø¬ÙŠÙƒ Ù„ÙŠÙ† Ø¨Ø§Ø¨ Ø¨ÙŠØªÙƒ Ø£Ùˆ Ø¯ÙˆØ§Ù…Ùƒ. Ø§Ø¶ØºØ· Ø§Ù„ØªØ§Ù„ÙŠ Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù†Ø·Ù‚Ø© ÙˆØ§Ù„Ø®Ø¯Ù…Ø©.</p>
          </div>
        </section>

        <!-- 2) Service -->
        <section id="page2" class="page" aria-label="Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø®Ø¯Ù…Ø©">
          <h1>ÙˆÙŠÙ†ØŒ ÙˆÙˆØ´ ØªØ¨ØºÙ‰ Ù†ØºØ³Ù„ØŸ</h1>
          <div class="card">
            <div class="grid cols-2">
              <div>
                <label for="area">Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</label>
                <select id="area">
                  <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</option>
                </select>
              </div>
              <div>
                <label for="cars">Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</label>
                <select id="cars">
                  <option value="1">Ù¡</option>
                  <option value="2">Ù¢</option>
                  <option value="3">Ù£</option>
                  <option value="4">Ù¤</option>
                </select>
              </div>
            </div>

            <label style="display:block;margin-top:14px">Ø§Ù„Ø®Ø¯Ù…Ø©</label>
            <div id="svcGrid" class="svc-grid" role="radiogroup"></div>
          </div>
        </section>

        <!-- 3) Time -->
        <section id="page3" class="page" aria-label="Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ¹Ø¯">
          <h1>Ù…ØªÙ‰ ÙŠÙ†Ø§Ø³Ø¨ÙƒØŸ</h1>
          <div class="card">
            <div class="grid cols-2">
              <div>
                <label for="date">Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                <input id="date" type="date" class="form-control"/>
              </div>
              <div>
                <label class="muted">Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</label>
                <div id="needBox" class="form-control" style="display:flex;align-items:center;justify-content:center;font-weight:900;">0/1</div>
              </div>
            </div>
            <div style="height:12px"></div>
            <div id="times" class="time-grid"></div>
          </div>
        </section>

        <!-- 4) Contact -->
        <section id="page4" class="page" aria-label="Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„">
          <h1>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„</h1>
          <div class="card">
            <div class="grid cols-2">
              <div>
                <label for="name">Ø§Ù„Ø§Ø³Ù…</label>
                <input id="name" type="text" class="form-control" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„"/>
              </div>
              <div>
                <label for="phone">Ø§Ù„Ø¬ÙˆØ§Ù„</label>
                <input id="phone" type="tel" class="form-control" placeholder="05XXXXXXXX"/>
              </div>
              <div>
                <label for="addr">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
                <input id="addr" type="text" class="form-control" placeholder="Ø§Ù„Ø­ÙŠ - Ø§Ù„Ø´Ø§Ø±Ø¹ - Ø±Ù‚Ù… Ø§Ù„Ù…Ù†Ø²Ù„"/>
              </div>
              <div>
                <label for="note">Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                <input id="note" type="text" class="form-control" placeholder="Ù†ÙˆØ¹ Ø§Ù„Ø³ÙŠØ§Ø±Ø©ØŒ Ù„ÙˆÙ†Ù‡Ø§â€¦"/>
              </div>
            </div>
          </div>
        </section>

        <!-- 5) Payment -->
        <section id="page5" class="page" aria-label="Ø§Ù„Ø¯ÙØ¹">
          <h1>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</h1>
          <div class="card">
            <div class="svc-grid" style="grid-template-columns:repeat(2,minmax(0,1fr))">
              <label class="svc-card" role="radio" aria-checked="false" tabindex="0">
                <input type="radio" name="pay" value="Ù…Ø¯Ù‰ / Ø¨Ø·Ø§Ù‚Ø©" hidden>
                <div class="svc-thumb">ğŸ’³</div>
                <div style="flex:1">
                  <div style="display:flex;gap:8px;align-items:center">
                    <h3 class="svc-title">Ù…Ø¯Ù‰ / Ø¨Ø·Ø§Ù‚Ø© Ø§Ø¦ØªÙ…Ø§Ù†ÙŠØ©</h3>
                    <span class="svc-cat">Ø³Ø±ÙŠØ¹</span>
                  </div>
                  <p class="svc-desc">Ù†Ø¯Ø¹Ù… ÙÙŠØ²Ø§ ÙˆÙ…Ø§Ø³ØªØ±</p>
                </div>
              </label>

              <label class="svc-card" role="radio" aria-checked="false" tabindex="0">
                <input type="radio" name="pay" value="Ù†Ù‚Ø¯Ø§Ù‹" hidden>
                <div class="svc-thumb">ğŸª™</div>
                <div style="flex:1">
                  <h3 class="svc-title">Ù†Ù‚Ø¯Ø§Ù‹</h3>
                  <p class="svc-desc">Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</p>
                </div>
              </label>
            </div>
          </div>
        </section>

        <!-- 6) Location hint (placeholder) -->
        <section id="page6" class="page" aria-label="Ø§Ù„Ù…ÙˆÙ‚Ø¹">
          <h1>Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©</h1>
          <div class="card">
            <p class="muted">Ø®Ø±ÙŠØ·Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) â€” Ø¹Ù†Ø¯ Ø§Ù„Ø¯Ù…Ø¬ Ù…Ø¹ Google Maps Ø§Ø³ØªØ®Ø¯Ù… <code>language=ar&region=SA</code>.</p>
            <div style="height:360px;border-radius:14px;background:linear-gradient(135deg,#101827,#0b1222);border:1px solid var(--border-700);display:flex;align-items:center;justify-content:center;color:#9aa7bd;">MAP PLACEHOLDER</div>
          </div>
        </section>

        <!-- 7) Review -->
        <section id="page7" class="page" aria-label="Ù…Ø±Ø§Ø¬Ø¹Ø©">
          <h1>Ø±Ø§Ø¬Ø¹ Ø·Ù„Ø¨Ùƒ</h1>
          <div class="card">
            <div class="grid">
              <div style="display:flex;justify-content:space-between"><span>Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</span><strong id="rv-area">â€”</strong></div>
              <div style="display:flex;justify-content:space-between"><span>Ø§Ù„Ø®Ø¯Ù…Ø©</span><strong id="rv-service">â€”</strong></div>
              <div style="display:flex;justify-content:space-between"><span>Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</span><strong id="rv-cars">â€”</strong></div>
              <div style="display:flex;justify-content:space-between"><span>Ø§Ù„ØªØ§Ø±ÙŠØ®</span><strong id="rv-date">â€”</strong></div>
              <div style="display:flex;justify-content:space-between"><span>Ø§Ù„Ø£ÙˆÙ‚Ø§Øª</span><strong id="rv-times">â€”</strong></div>
              <div style="display:flex;justify-content:space-between"><span>Ø§Ù„Ø§Ø³Ù…</span><strong id="rv-name">â€”</strong></div>
              <div style="display:flex;justify-content:space-between"><span>Ø§Ù„Ø¬ÙˆØ§Ù„</span><strong id="rv-phone">â€”</strong></div>
              <div style="display:flex;justify-content:space-between"><span>Ø§Ù„Ø¯ÙØ¹</span><strong id="rv-pay">â€”</strong></div>
              <hr style="border:none;border-top:1px solid var(--border-700)">
              <div style="display:flex;justify-content:space-between"><span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span><strong id="rv-total">â€”</strong></div>
            </div>
          </div>
        </section>

        <!-- 8) Done -->
        <section id="page8" class="page" aria-label="ØªÙ…">
          <h1>Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ! ğŸ‰</h1>
          <div class="card">
            <p class="muted">ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø·Ù„Ø¨. Ø³Ù†ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù„Ù„ØªØ£ÙƒÙŠØ¯.</p>
            <button class="btn primary" onclick="location.reload()">Ø­Ø¬Ø² Ø¬Ø¯ÙŠØ¯</button>
          </div>
        </section>
      </div>
    </div>
  </main>

  <footer class="sticky-nav">
    <div class="footer-inner">
      <button id="prevBtn" class="btn ghost" disabled>Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
      <button id="nextBtn" class="btn primary">Ø§Ù„ØªØ§Ù„ÙŠ</button>
    </div>
  </footer>

  <script>
  // ---------- Demo Data ----------
  const AREAS = ["Ø§Ù„Ø¬Ø¨ÙŠÙ„","Ø§Ù„Ø¯Ù…Ø§Ù…","Ø§Ù„Ø®Ø¨Ø±","Ø§Ù„Ø¸Ù‡Ø±Ø§Ù†","Ø§Ù„Ù‚Ø·ÙŠÙ"];
  const SERVICES = [
    {id:"basic", name:"Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©", cat:"Ø®Ø§Ø±Ø¬ÙŠ", price:35, desc:"ØºØ³ÙŠÙ„ Ø®Ø§Ø±Ø¬ÙŠ + Ù„Ù…Ø³Ø© Ø³Ø±ÙŠØ¹Ø©"},
    {id:"pro",   name:"Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ù…ØªÙˆØ³Ø·Ø©", cat:"Ø®Ø§Ø±Ø¬ÙŠ + Ø¯Ø§Ø®Ù„ÙŠ", price:55, desc:"Ø®Ø§Ø±Ø¬ÙŠ ÙŠØ¯ÙˆÙŠ + ØªÙ†Ø¸ÙŠÙ Ø¯Ø§Ø®Ù„ÙŠ"},
    {id:"vip",   name:"VIP", cat:"Ø®Ø§Ø±Ø¬ÙŠ + Ø¯Ø§Ø®Ù„ÙŠ", price:99, desc:"Ø±ØºÙˆØ© Ø§Ù„Ù†Ø§Ù†Ùˆ + ØªÙ„Ù…ÙŠØ¹ Ø¹Ù…ÙŠÙ‚"}
  ];
  const formatSAR = n => new Intl.NumberFormat("ar-SA",{style:"currency",currency:"SAR"}).format(n);

  const steps = ["page1","page2","page3","page4","page5","page6","page7","page8"];
  const labels= ["Ø§Ù„ØªØ±Ø­ÙŠØ¨","Ø§Ù„Ø®Ø¯Ù…Ø©","Ø§Ù„ÙˆÙ‚Øª","Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª","Ø§Ù„Ø¯ÙØ¹","Ø§Ù„Ù…ÙˆÙ‚Ø¹","Ù…Ø±Ø§Ø¬Ø¹Ø©","ØªÙ…"];
  const state  = { area:"", service:null, cars:1, date:"", times:[], name:"", phone:"", pay:"", total:0 };

  const $ = s => document.querySelector(s);

  // Theme toggle (optional light)
  document.getElementById("toggleTheme").addEventListener("click", ()=>{
    const r=document.documentElement;
    r.dataset.theme = r.dataset.theme==="ginza-zen" ? "tokyo-neon" : "ginza-zen";
    toast(r.dataset.theme==="ginza-zen" ? "ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù†Ù…Ø· Zen" : "ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù†Ù…Ø· Neon");
  });

  // Init
  (function init(){
    const area = $("#area");
    AREAS.forEach(a => area.append(new Option(a,a)));
    $("#cars").addEventListener("change", e => { state.cars = +e.target.value; paintNeed(); });

    const grid = $("#svcGrid");
    SERVICES.forEach(s=>{
      const card = document.createElement("label");
      card.className = "svc-card";
      card.setAttribute("role","radio");
      card.setAttribute("aria-checked","false");
      card.tabIndex = 0;
      card.innerHTML = `
        <input type="radio" name="svc" value="${s.id}" hidden>
        <div class="svc-thumb">ğŸ§¼</div>
        <div style="flex:1">
          <div style="display:flex;gap:8px;align-items:center">
            <h3 class="svc-title">${s.name}</h3>
            <span class="svc-cat">${s.cat}</span>
          </div>
          <p class="svc-desc">${s.desc}</p>
          <span class="price">${formatSAR(s.price)}</span>
        </div>`;
      card.addEventListener("click", ()=> chooseService(s.id, card));
      card.addEventListener("keydown", e=>{ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); chooseService(s.id, card); }});
      grid.append(card);
    });

    // date default
    const d = new Date(); $("#date").value = d.toISOString().slice(0,10);
    $("#date").addEventListener("change", paintTimes);
    paintTimes();
    paintNeed();
    syncChips();
  })();

  function chooseService(id, el){
    document.querySelectorAll('#svcGrid .svc-card').forEach(c=>c.setAttribute('aria-checked','false'));
    el.setAttribute('aria-checked','true');
    state.service = SERVICES.find(x=>x.id===id);
    syncChips();
  }

  function paintTimes(){
    const times = $("#times"); times.innerHTML = "";
    const slots = ["06:00","07:00","08:00","09:00","10:00","11:00","13:00","15:00","17:00","19:00"];
    slots.forEach(t=>{
      const b=document.createElement("button");
      b.type="button"; b.className="time-option"; b.textContent=t; b.setAttribute("aria-pressed","false");
      b.addEventListener("click",()=>{
        const need = state.cars;
        const idx = state.times.indexOf(t);
        if(idx>=0){ state.times.splice(idx,1); }
        else{
          if(state.times.length>=need){ toast(`Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø®ØªÙŠØ§Ø± Ø£ÙƒØ«Ø± Ù…Ù† ${need} ÙˆÙ‚Øª`); return; }
          state.times.push(t);
        }
        paintNeed();
        b.setAttribute("aria-pressed", state.times.includes(t) ? "true" : "false");
        syncChips();
      });
      times.append(b);
    });
    state.date = $("#date").value;
  }

  function paintNeed(){ $("#needBox").textContent = `${state.times.length}/${state.cars}`; }

  // Nav
  $("#prevBtn").addEventListener("click", ()=> go(-1));
  $("#nextBtn").addEventListener("click", onNext);

  function onNext(){
    const i = getIndex();
    const id = steps[i];

    if(id==="page1"){ go(1); return; }
    if(id==="page2"){
      const area = $("#area").value;
      if(!area || !state.service){ toast("Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø© ÙˆØ§Ù„Ø®Ø¯Ù…Ø©"); return; }
      state.area = area; go(1); return;
    }
    if(id==="page3"){
      if(state.times.length !== state.cars){ toast(`Ø§Ø®ØªØ± ${state.cars} ÙˆÙ‚Øª`); return; }
      state.date = $("#date").value; go(1); return;
    }
    if(id==="page4"){
      const name=$("#name").value.trim(), phone=$("#phone").value.trim();
      if(!name || !phone){ toast("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„"); return; }
      state.name = name; state.phone = phone; go(1); return;
    }
    if(id==="page5"){
      const sel = document.querySelector('input[name="pay"]:checked');
      if(!sel){ toast("Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹"); return; }
      state.pay = sel.value; go(1); return;
    }
    if(id==="page6"){ go(1); return; }
    if(id==="page7"){ toast("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨"); go(1); return; }
  }

  function go(step){
    const i = getIndex();
    const next = Math.max(0, Math.min(steps.length-1, i+step));
    showPage(next);
  }

  function getIndex(){
    const id = document.querySelector(".page.active")?.id;
    return Math.max(0, steps.indexOf(id));
  }

  function showPage(idx){
    const cur = document.querySelector(".page.active");
    const next = document.getElementById(steps[idx]);
    if(cur){ cur.classList.remove("active"); cur.classList.add("exit"); setTimeout(()=>cur.classList.remove("exit"), 220); }
    if(next){ next.classList.add("active"); }

    $("#prevBtn").disabled = idx===0 || idx===steps.length-1;
    $("#nextBtn").textContent = (steps[idx]==="page7") ? "ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²" : (steps[idx]==="page8" ? "ØªÙ…" : "Ø§Ù„ØªØ§Ù„ÙŠ");
    $("#nextBtn").disabled = steps[idx]==="page8";

    const pct = ((idx+1)/steps.length)*100;
    $("#miniBar").style.width = pct+"%";
    $("#miniStep").textContent = labels[idx];

    if(steps[idx]==="page7"){ renderReview(); }
    syncChips();
    scrollTo({top:0,behavior:"smooth"});
  }

  function renderReview(){
    $("#rv-area").textContent   = state.area || "â€”";
    $("#rv-service").textContent= state.service? state.service.name : "â€”";
    $("#rv-cars").textContent   = state.cars;
    $("#rv-date").textContent   = state.date || "â€”";
    $("#rv-times").textContent  = state.times.length ? state.times.join(" ØŒ ") : "â€”";
    $("#rv-name").textContent   = state.name || "â€”";
    $("#rv-phone").textContent  = state.phone || "â€”";
    $("#rv-pay").textContent    = state.pay || "â€”";
    const total = (state.service?state.service.price:0) * state.cars;
    state.total = total; $("#rv-total").textContent = formatSAR(total);
  }

  function syncChips(){
    const wrap = $("#chips"); wrap.innerHTML = "";
    const chips = [
      state.area && ["ğŸ“","Ø§Ù„Ù…Ù†Ø·Ù‚Ø©",state.area],
      state.service && ["ğŸ§¼","Ø§Ù„Ø®Ø¯Ù…Ø©",state.service.name],
      state.cars && ["ğŸš—","Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª",state.cars],
      state.date && state.times.length && ["ğŸ•’","Ø§Ù„Ù…ÙˆØ¹Ø¯",`${state.date} â€¢ ${state.times.join("ØŒ ")}`],
      state.pay && ["ğŸ’³","Ø§Ù„Ø¯ÙØ¹",state.pay]
    ].filter(Boolean);

    chips.forEach((c,idx)=>{
      const el=document.createElement("div");
      el.className="chip"+(idx===chips.length-1?" current":"");
      el.innerHTML=`<span>${c[0]}</span><span>${c[1]}:</span><strong>&nbsp;${c[2]}</strong>`;
      wrap.append(el);
    });
  }

  function toast(msg){
    const t = $("#toast");
    t.textContent = msg; t.style.display="block";
    setTimeout(()=>{ t.style.opacity="0"; setTimeout(()=>{ t.style.display="none"; t.style.opacity="1"; }, 220); }, 1600);
  }

  // Payment card keyboard
  document.addEventListener("click", e=>{
    const card = e.target.closest('#page5 .svc-card');
    if(card){
      document.querySelectorAll('#page5 .svc-card').forEach(c=>c.setAttribute('aria-checked','false'));
      card.setAttribute('aria-checked','true');
      card.querySelector('input[name="pay"]').checked = true;
    }
  });
  </script>
</body>
</html>
